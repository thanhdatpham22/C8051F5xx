C51 COMPILER V9.54   UART                                                                  04/18/2025 16:38:19 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN uart.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.exe uart.c DB OE BR INCDIR(C:\SiLabs\MCU_4\Inc)

line level    source

   1          #include <compiler_defs.h>
   2          #include <C8051F580_defs.h> 
   3          
   4          #define BAUDRATE                115200
   5          #define SYSCLK          24000000   
   6          
   7          #define UART1_BUFFERSIZE 64
   8          
   9          SEGMENT_VARIABLE(UART1_Buffer[UART1_BUFFERSIZE], U8, SEG_XDATA);
  10          U8 UART1_Buffer_Size = 0;
  11          bit UART1_Received_Full = 0; 
  12          static U8 Byte;
  13          
  14          
  15          void UART1_Init (void)
  16          {
  17   1         U8 SFRPAGE_save = SFRPAGE;
  18   1         SFRPAGE = ACTIVE2_PAGE;
  19   1      
  20   1         SCON1 = 0x10;                       // SCON1: 8-bit variable bit rate
  21   1      
  22   1         if (SYSCLK / BAUDRATE / 2 / 256 < 1) 
  23   1         {
  24   2            TH1 = -(SYSCLK / BAUDRATE / 2);
  25   2            CKCON &= ~0x0B;                  // T1M = 1; SCA1:0 = xx
  26   2            CKCON |=  0x08;
  27   2         } 
  28   1         else if (SYSCLK / BAUDRATE / 2 / 256 < 4) 
  29   1         {
  30   2            TH1 = -(SYSCLK / BAUDRATE / 2 / 4);
  31   2            CKCON &= ~0x0B;                  // T1M = 0; SCA1:0 = 01
  32   2            CKCON |=  0x01;
  33   2         } 
  34   1         else if (SYSCLK / BAUDRATE / 2 / 256 < 12) 
  35   1         {
  36   2            TH1 = -(SYSCLK / BAUDRATE / 2 / 12);
  37   2            CKCON &= ~0x0B;                  // T1M = 0; SCA1:0 = 00
  38   2         } 
  39   1         else 
  40   1         {
  41   2            TH1 = -(SYSCLK / BAUDRATE / 2 / 48);
  42   2            CKCON &= ~0x0B;                  // T1M = 0; SCA1:0 = 10
  43   2            CKCON |=  0x02;
  44   2         }
  45   1      
  46   1          TL1 = TH1;                          // Init Timer1
  47   1          TMOD &= ~0xF0;                      // TMOD: timer 1 in 8-bit autoreload
  48   1          TMOD |=  0x20;
  49   1          TR1 = 1;                            // START Timer1
  50   1      
  51   1          TI1 = 1;                            // Indicate TX0 ready (SCON1)
  52   1              EIE2 |= 0x08;
  53   1          SFRPAGE = SFRPAGE_save;
  54   1      }
  55          
C51 COMPILER V9.54   UART                                                                  04/18/2025 16:38:19 PAGE 2   

  56          INTERRUPT(UART1_ISR, INTERRUPT_UART1)
  57          { 
  58   1              U8 SFRPAGE_save = SFRPAGE;
  59   1          SFRPAGE = ACTIVE2_PAGE;
  60   1              if (RI1 == 1)
  61   1          {
  62   2                  Byte = SBUF1;                    
  63   2                  if (UART1_Buffer_Size < UART1_BUFFERSIZE)
  64   2                  {
  65   3                     UART1_Buffer[UART1_Buffer_Size] = Byte; // Store in array
  66   3                     UART1_Buffer_Size++;                      
  67   3                  }
  68   2      
  69   2                      else
  70   2                      {
  71   3                              UART1_Buffer_Size = 0;
  72   3                      }
  73   2      
  74   2                      RI1 = 0;  
  75   2                           
  76   2          }
  77   1              SFRPAGE = SFRPAGE_save;
  78   1      }
*** WARNING C294 IN LINE 30 OF uart.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    103    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     64    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
